<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>RealTime Dashboard with ASP.NET Signalr, AngularJS and D3JS | Arul Selvan</title>
<meta name="keywords" content="">
<meta name="description" content="About Signalr :
Asp.NET SignalR is a library for ASP.NET developers to push the content from server to connected clients and vise versa.
Reference Link: http://signalr.net/ ,  http://www.asp.net/signalr/
About AngularJS :
AngularJS is an opensource web application client side framework, maintained by Google and community.
Reference Link: https://angularjs.org/ About D3js :
D3.js is a javascript library for manipulating document based on data. It helps in bringing data to visualization using HTML,SVG and CSS.">
<meta name="author" content="arul">
<link rel="canonical" href="https://arulselvan.net/realtime-dashboard-asp-net-signalr-angularjs-d3js/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.6da9a63d25a9608bca2f7f907a030e887a7dd3c3f3918e4cc113129361414bda.css" integrity="sha256-bammPSWpYIvKL3&#43;QegMOiHp908PzkY5MwRMSk2FBS9o=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://arulselvan.net/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://arulselvan.net/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://arulselvan.net/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://arulselvan.net/apple-touch-icon.png">
<link rel="mask-icon" href="https://arulselvan.net/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://arulselvan.net/realtime-dashboard-asp-net-signalr-angularjs-d3js/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="https://arulselvan.net/realtime-dashboard-asp-net-signalr-angularjs-d3js/">
  <meta property="og:site_name" content="Arul Selvan">
  <meta property="og:title" content="RealTime Dashboard with ASP.NET Signalr, AngularJS and D3JS">
  <meta property="og:description" content="About Signalr :
Asp.NET SignalR is a library for ASP.NET developers to push the content from server to connected clients and vise versa.
Reference Link: http://signalr.net/ , http://www.asp.net/signalr/
About AngularJS :
AngularJS is an opensource web application client side framework, maintained by Google and community.
Reference Link: https://angularjs.org/ About D3js :
D3.js is a javascript library for manipulating document based on data. It helps in bringing data to visualization using HTML,SVG and CSS.">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2014-10-15T08:24:51+00:00">
    <meta property="article:modified_time" content="2014-10-15T08:24:51+00:00">
    <meta property="og:image" content="https://arulselvan.net/wp-content/uploads/2014/10/demo_screen-1024x5551212-1.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://arulselvan.net/wp-content/uploads/2014/10/demo_screen-1024x5551212-1.png">
<meta name="twitter:title" content="RealTime Dashboard with ASP.NET Signalr, AngularJS and D3JS">
<meta name="twitter:description" content="About Signalr :
Asp.NET SignalR is a library for ASP.NET developers to push the content from server to connected clients and vise versa.
Reference Link: http://signalr.net/ ,  http://www.asp.net/signalr/
About AngularJS :
AngularJS is an opensource web application client side framework, maintained by Google and community.
Reference Link: https://angularjs.org/ About D3js :
D3.js is a javascript library for manipulating document based on data. It helps in bringing data to visualization using HTML,SVG and CSS.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://arulselvan.net/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "RealTime Dashboard with ASP.NET Signalr, AngularJS and D3JS",
      "item": "https://arulselvan.net/realtime-dashboard-asp-net-signalr-angularjs-d3js/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "RealTime Dashboard with ASP.NET Signalr, AngularJS and D3JS",
  "name": "RealTime Dashboard with ASP.NET Signalr, AngularJS and D3JS",
  "description": "About Signalr :\nAsp.NET SignalR is a library for ASP.NET developers to push the content from server to connected clients and vise versa.\nReference Link: http://signalr.net/ , http://www.asp.net/signalr/\nAbout AngularJS :\nAngularJS is an opensource web application client side framework, maintained by Google and community.\nReference Link: https://angularjs.org/ About D3js :\nD3.js is a javascript library for manipulating document based on data. It helps in bringing data to visualization using HTML,SVG and CSS.\n",
  "keywords": [
    
  ],
  "articleBody": "About Signalr :\nAsp.NET SignalR is a library for ASP.NET developers to push the content from server to connected clients and vise versa.\nReference Link: http://signalr.net/ , http://www.asp.net/signalr/\nAbout AngularJS :\nAngularJS is an opensource web application client side framework, maintained by Google and community.\nReference Link: https://angularjs.org/ About D3js :\nD3.js is a javascript library for manipulating document based on data. It helps in bringing data to visualization using HTML,SVG and CSS.\nReference Link: http://d3js.org/\nOkay We can start now. In this article we are going to see how to build real-time dashboard application using above technologies, for sample I took scenario of available waiting calls in the call centre (contact center) on each department. so this sample real time dashboard will be benefit for contact center manager and supervisor to monitor how many customers are waiting in the queue to get the agent transfer.\nServer Side Implementation:\nSignalR is an abstraction over some of the transports (WebSoket,Server Sent Event ,Forever Frame,Ajax long polling ). It will also support fallback. For example if we take WebSocket transpor,it should meet some of the system requirement from both server and client end.\nServer end: Windows Server 2012 or Windows 8\nClient end: Html5 supported browser(IE 10+, chrome,etc..)\nIf any one of the requirement gets failed, obviously websocket will not work. Here Signalr will do magic, automatically it will look for alternative supported transport.(Forever or Ajax). So developer don’t want to worry about anything.\nTo Learn more about SignalR please visit following link http://www.asp.net/signalr/. In below we are going to see only how these technologies makes our Job easy to build real time solution.\nThe Server side Hub:\nThis will push content to clients.\npublic class RealTimeQueueHub : Hub { } Client Side Hub connection with (angularJS) :\nReference file require in HTML page.\nWe having our client connection inside angular JS service because Service are singleton and easy to take control for callback.\nvar myApp=angular.module('myApp', []); myApp.service('queueService', function ($rootScope) { var hub = $.connection.realTimeQueueHub; hub.client.receiveRealTimeData = function (data) { //broadcast the received data to all the subscribed controller. $rootScope.$emit(\"acceptData\", data); }; $.connection.hub.start(); // start the signalr connection }); Controller will receive the data from service then pass to $scope variable to update the user interface.\nmyApp.controller('Ctrl',['$scope','$rootScope','queueService',function Ctrl($scope,$rootScope,queueService) { $scope.loading=true; $rootScope.$on(\"acceptData\",function(e,message){ $scope.$apply(function(){ $scope.myData= message; }); $scope.loading=false; }); }]); angular JS is two way binding, once the data updated in the controller, view automatically re-rendered based on updated values.\nInside view we have custom directive to draw simple bar chat based on myData value. This custom directive we build with the help of D3.JS .\n//custom directive to create the bar chart with help of D3.js myApp.directive('barsChart', function ($parse) { var directiveDefinitionObject = { restrict: 'E', replace: true, scope: { data: '=chartData', title: '@' }, template: '{{title}}', link: function (scope, element, attrs, ctrl) { scope.$watchCollection('data', function (newVal, oldVal) { if (!newVal) return; var chart = d3.select('.chart'); chart.selectAll('div').remove().transition().ease(\"elastic\"); chart.selectAll('div') .data(newVal).enter().append(\"div\").transition().ease(\"elastic\") .style(\"width\", function (d) { return (d.value) + \"%\" }) .style(\"background-color\", function (d) { //This background style will help to segregate bar based on some threshold value if (d.value \u003e 30 \u0026\u0026 d.value \u003c= 60) return \"#D4A835\"; else if (d.value \u003e 60) return \"#E0272A\"; else return \"#2F9756\"; }) .text(function (d) { return d.label + \" (\" + d.value + \")\"; }); }); } }; return directiveDefinitionObject; }); Now again we can go to server end. We have to pull the real time data from database or some back end system with some specified interval then push the data to all our subscribed client.\nReally running scheduled background work in asp.net I will not suggest, Even this example we used official recommended approach IReggisteredObject with the ASP.NET runtime and hook it up at application start.\nFor more robust solution even we can host the signalR explicit windows service.\npublic class BackgroundProcess : IRegisteredObject { private Timer _timer; private IHubContext _hub; public BackgroundProcess() { HostingEnvironment.RegisterObject(this); _hub = GlobalHost.ConnectionManager.GetHubContext(); _timer = new Timer(OnTimerElapsed, null, TimeSpan.FromSeconds(1), TimeSpan.FromSeconds(5)); } private void OnTimerElapsed(object sender) { // Here we can do our logic to get the data from API / Database . // This example just I am taking random value and pushing to all connected clients. var rnd = new Random(); var updatedValues = new List{ new RealTimeData(\"CreditCard\",rnd.Next(1,100)), new RealTimeData(\"Banking\",rnd.Next(1,100)), new RealTimeData(\"Loan\",rnd.Next(1,100)), new RealTimeData(\"Other Service\",rnd.Next(1,100)), }; _hub.Clients.All.ReceiveRealTimeData(updatedValues); } public void Stop(bool immediate) { _timer.Dispose(); HostingEnvironment.UnregisterObject(this); } } In Application_Start method simply we can start our background thread.\npublic class WebApiApplication : System.Web.HttpApplication { protected void Application_Start() { AreaRegistration.RegisterAllAreas(); GlobalConfiguration.Configure(WebApiConfig.Register); RouteConfig.RegisterRoutes(RouteTable.Routes); BundleConfig.RegisterBundles(BundleTable.Bundles); //starting our background thread process new BackgroundProcess(); } } Here we are simply pushing the data to all the connected clients, But real time we can do lot more, maintain active client, identifying particular user and pushing to only logged in clients, etc…\nSnapshot :\n",
  "wordCount" : "816",
  "inLanguage": "en",
  "image":"https://arulselvan.net/wp-content/uploads/2014/10/demo_screen-1024x5551212-1.png","datePublished": "2014-10-15T08:24:51Z",
  "dateModified": "2014-10-15T08:24:51Z",
  "author":{
    "@type": "Person",
    "name": "arul"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://arulselvan.net/realtime-dashboard-asp-net-signalr-angularjs-d3js/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Arul Selvan",
    "logo": {
      "@type": "ImageObject",
      "url": "https://arulselvan.net/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://arulselvan.net/" accesskey="h" title="Arul Selvan (Alt + H)">Arul Selvan</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://arulselvan.net/archives/" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="https://arulselvan.net/talks/" title="Talks">
                    <span>Talks</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      RealTime Dashboard with ASP.NET Signalr, AngularJS and D3JS
    </h1>
    <div class="post-meta"><span title='2014-10-15 08:24:51 +0000 +0000'>October 15, 2014</span>&nbsp;·&nbsp;arul

</div>
  </header> 
<figure class="entry-cover">
        <img loading="eager" src="https://arulselvan.net/wp-content/uploads/2014/10/demo_screen-1024x5551212-1.png" alt="demo_screen-1024x5551212">
        
</figure>
  <div class="post-content"><p><strong>About Signalr :</strong></p>
<p>Asp.NET SignalR is a library for ASP.NET developers to push the content from server to connected clients and vise versa.</p>
<p>Reference Link: <a href="http://signalr.net/" title="SignalR">http://signalr.net/</a> ,  <a href="http://www.asp.net/signalr/overview/signalr-20/getting-started-with-signalr-20/introduction-to-signalr" title="SignalR Introduction">http://www.asp.net/signalr</a>/</p>
<p><strong>About AngularJS :</strong></p>
<p>AngularJS is an opensource web application client side framework, maintained by Google and community.</p>
<p>Reference Link: <a href="https://angularjs.org/" title="AngularJS">https://angularjs.org/</a> <strong>About D3js :</strong></p>
<p>D3.js is a javascript library for manipulating document based on data. It helps in bringing data to visualization using HTML,SVG and CSS.</p>
<p>Reference Link: <a href="http://d3js.org/" title="D3 Link">http://d3js.org/</a></p>
<p>Okay We can start now. In this article we are going to see how to build real-time dashboard application using above technologies, for sample I took scenario of available waiting calls in the call centre  (contact center) on each department. so this sample real time dashboard will be benefit for contact center manager and supervisor to monitor how many customers are waiting in the queue to get the agent transfer.</p>
<p><strong>Server Side Implementation:</strong></p>
<p>SignalR is an abstraction over some of the transports (WebSoket,Server Sent Event ,Forever Frame,Ajax long polling ). It will also support  fallback. For example if we take WebSocket transpor,it should meet some of the system requirement from both server and client end.</p>
<p>Server end: Windows Server 2012 or Windows 8</p>
<p>Client  end: Html5 supported browser(IE 10+, chrome,etc..)</p>
<p>If any one of the requirement gets failed, obviously websocket will not work. Here  Signalr will do magic, automatically it will look for alternative supported transport.(Forever or Ajax). So developer don&rsquo;t want to worry  about anything.</p>
<p>To Learn more about SignalR please visit following link <a href="http://www.asp.net/signalr/">http://www.asp.net/signalr/</a>. In below we are going to see only how these technologies makes our Job easy to build real time solution.</p>
<p><strong>The Server side Hub:</strong></p>
<p>This will push content to clients.</p>
<pre tabindex="0"><code class="language-default" data-lang="default">public class RealTimeQueueHub : Hub
{

}
</code></pre><p><strong>Client Side Hub connection with (angularJS) :</strong></p>
<p>Reference file require in HTML page.</p>
<pre tabindex="0"><code class="language-default" data-lang="default">&lt;script src=&#34;Scripts/jquery-1.6.4.min.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;Scripts/angular.min.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;Scripts/jquery.signalR-2.1.0.min.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;/signalr/hubs&#34;&gt;&lt;/script&gt;
</code></pre><p>We having  our client connection inside angular JS service because Service are singleton and easy to take control for callback.</p>
<pre tabindex="0"><code class="language-default" data-lang="default">var myApp=angular.module(&#39;myApp&#39;, []);

myApp.service(&#39;queueService&#39;, function ($rootScope) {

        var hub = $.connection.realTimeQueueHub;

        hub.client.receiveRealTimeData = function (data) {

            //broadcast the received data  to all the subscribed controller.

            $rootScope.$emit(&#34;acceptData&#34;, data);
        };

        $.connection.hub.start();  // start the signalr connection

});
</code></pre><p>Controller will  receive the data from service then pass to $scope variable  to update the user interface.</p>
<pre tabindex="0"><code class="language-default" data-lang="default">myApp.controller(&#39;Ctrl&#39;,[&#39;$scope&#39;,&#39;$rootScope&#39;,&#39;queueService&#39;,function Ctrl($scope,$rootScope,queueService) {

		$scope.loading=true;

		$rootScope.$on(&#34;acceptData&#34;,function(e,message){

				$scope.$apply(function(){
						$scope.myData= message;
				});

				$scope.loading=false;
		});

}]);
</code></pre><p>angular JS is two way binding, once the data updated in the controller, view automatically re-rendered based on updated values.</p>
<pre tabindex="0"><code class="language-default" data-lang="default">&lt;div ng-app=&#34;myApp&#34; ng-controller=&#34;Ctrl&#34;&gt;
	&lt;bars-chart chart-data=&#34;myData&#34; title=&#39;Queue RealTime Dashboard&#39; &gt; &lt;/bars-chart&gt;
&lt;/div&gt;
</code></pre><p>Inside view we have custom directive to  draw simple bar chat based on myData value. This custom directive we build with the help of D3.JS .</p>
<pre tabindex="0"><code class="language-default" data-lang="default">//custom directive to create the bar chart with help of D3.js
myApp.directive(&#39;barsChart&#39;, function ($parse) {

    var directiveDefinitionObject = {

        restrict: &#39;E&#39;,
        replace: true,
        scope: { data: &#39;=chartData&#39;, title: &#39;@&#39; },
        template: &#39;&lt;div class=&#34;chart&#34;&gt;&lt;h3 class=&#34;chartTitle&#34;&gt;{{title}}&lt;h3&gt;&lt;/div&gt;&#39;,
        link: function (scope, element, attrs, ctrl) {

            scope.$watchCollection(&#39;data&#39;, function (newVal, oldVal) {

                if (!newVal)
                    return;

                var chart = d3.select(&#39;.chart&#39;);
                chart.selectAll(&#39;div&#39;).remove().transition().ease(&#34;elastic&#34;);

                chart.selectAll(&#39;div&#39;)
					.data(newVal).enter().append(&#34;div&#34;).transition().ease(&#34;elastic&#34;)
					.style(&#34;width&#34;, function (d) { return (d.value) + &#34;%&#34; })
					.style(&#34;background-color&#34;, function (d) {

					    //This background style will help to segregate bar based on some threshold value

					    if (d.value &gt; 30 &amp;&amp; d.value &lt;= 60)
					        return &#34;#D4A835&#34;;
					    else if (d.value &gt; 60)
					        return &#34;#E0272A&#34;;
					    else
					        return &#34;#2F9756&#34;;

					})
				 .text(function (d) { return d.label + &#34;  (&#34; + d.value + &#34;)&#34;; });

            });

        }
    };
    return directiveDefinitionObject;
});
</code></pre><p>Now again we can go to server end. We have to pull the real time data from  database or some back end system with some specified interval  then push the data to all our subscribed client.</p>
<p>Really running scheduled background work in asp.net I will not suggest, Even this example we used official recommended approach  IReggisteredObject with the ASP.NET runtime and hook it up at application start.</p>
<p>For more robust solution even we can host the signalR explicit windows service.</p>
<pre tabindex="0"><code class="language-default" data-lang="default"> public class BackgroundProcess : IRegisteredObject
    {
        private Timer _timer;
        private IHubContext _hub;

        public BackgroundProcess()
        {
            HostingEnvironment.RegisterObject(this);

            _hub = GlobalHost.ConnectionManager.GetHubContext&lt;RealTimeQueueHub&gt;();

            _timer = new Timer(OnTimerElapsed, null,
                TimeSpan.FromSeconds(1), TimeSpan.FromSeconds(5));
        }

        private void OnTimerElapsed(object sender)
        {
            // Here we can do our logic to get the data from API / Database .
            // This example just I am taking random value and pushing to all connected clients.

            var rnd = new Random();

            var updatedValues = new List&lt;RealTimeData&gt;{
                    new RealTimeData(&#34;CreditCard&#34;,rnd.Next(1,100)),
                    new RealTimeData(&#34;Banking&#34;,rnd.Next(1,100)),
                    new RealTimeData(&#34;Loan&#34;,rnd.Next(1,100)),
                    new RealTimeData(&#34;Other Service&#34;,rnd.Next(1,100)),

            };

            _hub.Clients.All.ReceiveRealTimeData(updatedValues);
        }
        public void Stop(bool immediate)
        {
            _timer.Dispose();
            HostingEnvironment.UnregisterObject(this);
        }
    }
</code></pre><p>In Application_Start method simply we can start our background thread.</p>
<pre tabindex="0"><code class="language-default" data-lang="default"> public class WebApiApplication : System.Web.HttpApplication
    {
        protected void Application_Start()
        {
            AreaRegistration.RegisterAllAreas();
            GlobalConfiguration.Configure(WebApiConfig.Register);
            RouteConfig.RegisterRoutes(RouteTable.Routes);
            BundleConfig.RegisterBundles(BundleTable.Bundles);

            //starting our background thread process
            new BackgroundProcess();
        }
    }
</code></pre><p>Here we are simply pushing the data to all the connected clients, But real time we can do lot more,  maintain active client, identifying particular user and  pushing to only logged in clients, etc&hellip;</p>
<p>Snapshot :</p>
<p><a href="/wp-content/uploads/2014/10/demo_screen.png"><img alt="demo_screen" loading="lazy" src="/wp-content/uploads/2014/10/demo_screen-1024x555.png"></a></p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://arulselvan.net/">Arul Selvan</a></span> · 

</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
